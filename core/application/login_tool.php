<?php define("TO_ROOT", "../..");  header("Content-Type: application/json");$returnData = Array();$returnData["id"] = (isset($_GET["id"])) ? $_GET["id"] : false;$returnData["password"] = (isset($_GET["password"])) ? $_GET["password"] : false;$returnData["id"] = ($returnData["id"] == false) ? $_POST["id"] : $returnData["id"] ;$returnData["password"] = ($returnData["password"] == false) ? $_POST["password"] : $returnData["password"] ;if($returnData["id"] != false ){	if($returnData["password"] != false )	{		require_once TO_ROOT . "/core/includes/main.inc.php";		$DbConnection = DbConnection::getInstance("_root"); 				$id = explode("@", $returnData["id"]);		$mail = $id["0"];		$password = md5($returnData["password"]);				$table = ( !preg_match("/^[0-9]+$/", $returnData["id"]) ) ? "mail" : "member_id" ;				switch ($table)		{			case "member_id":				$sql= "SELECT user_login_id, password, mail FROM user_login WHERE member_id = '{$returnData["id"]}'";				$data = $DbConnection->getRow($sql);				break;			case "mail":				$found = false;				$sql= "SELECT user_login_id, password, mail FROM user_login WHERE mail LIKE '{$mail}@%'";				$users = $DbConnection->getAll($sql);								if($users)				{					foreach ($users AS $user)					{						$user_mail = explode("@", $user["mail"]);												if( ($found == false) && ($mail == $user_mail["0"]) && ($password == $user["password"]))						{							$returnData["found"] = true;							$found = true;							$data = $user;						} else if($found == false) {							$found = false;							$data["mail"] = $user["mail"];							$data["password"] = "NOT_PASSWORD";						}					}					break;				}		}				if( $password === $data["password"] )		{			$Login = Login::getInstance($data["user_login_id"]);    		$Login->load();    	    		if($Login->data["active"] == 1)    		{    			Functions::__sessionDestroy();				$Login->loadSession();								$returnData["success"] = "1";    			$returnData["session"] = $_SESSION;	    		} else {    			$returnData["success"] = "0";    			$returnData["reason"] = "INACTIVE";	    		}     				} else {	    	$returnData["success"] = "0";	    	$returnData["reason"] = "PASSWORD_NOT_MATCH";		} 				if( !$data )		{			$returnData["success"] = "0";			$returnData["reason"] = "NOT_USER";		}		} else {		$returnData["success"] = "0";		$returnData["reason"] = "NOT_PASSWORD";	}} else {	$returnData["success"] = "0";	$returnData["reason"] = "NOT_ID";}echo json_encode($returnData);